


f()(
    local WSROOT=
    WSROOT="$(x wsroot)"
    xws pub

    set -o errexit
    x mkdirp tmp/
    cd tmp || return
    if [ -d advise ]; then
        cd advise || return
        git stash
        git clean -fd
        git config pull.rebase false
        git pull git@github.com:x-cmd/advise
    else
        git clone git@github.com:x-cmd/advise
        cd advise || return
    fi

    cp -r "$WSROOT/dist" ./
    git add dist/all.tgz
    git commit -m "update: dist/all.tgz"

    x:info git push ${force+-f} git@gitee.com:"$(x git meta name)"
    git push ${force+-f} git@gitee.com:"$(x git meta name)"

    x:info git push ${force+-f} git@github.com:"$(x git meta name)"
    git push ${force+-f} git@github.com:"$(x git meta name)"
)

f